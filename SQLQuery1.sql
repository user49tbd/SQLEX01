CREATE DATABASE CLINICA
DROP DATABASE CLINICA
USE CLINICA
USE master

CREATE TABLE PACIENTE(
NUM_BENEFICIARIO	INT					NOT NULL,
NOME				VARCHAR(100)		NOT NULL,
LOGRADOURO			VARCHAR(200)		NOT NULL,
NUMERO				INT					NOT NULL,
CEP					CHAR(8)				NOT NULL,
COMPLEMENTO			VARCHAR(255)	    NOT NULL,
TELEFONE			VARCHAR(11)			NOT NULL
PRIMARY KEY (NUM_BENEFICIARIO)
)

CREATE TABLE ESPECIALIDADE(
ID					INT					NOT NULL,
ESPECIALIDADE		VARCHAR(100)		NOT NULL
PRIMARY KEY (ID)
)

EXEC SP_HELP PACIENTE

CREATE TABLE MEDICO (
CODIGO				INT					NOT NULL,
NOME				VARCHAR(100)		NOT NULL,
LOGRADOURO			VARCHAR(200)		NOT NULL,
NUMERO				INT					NOT NULL,
CEP					CHAR(8)				NOT NULL,
COMPLEMENTO			VARCHAR(255)		NOT NULL,
CONTATO				VARCHAR(11)			NOT NULL,
ESPECIALIDADE_ID	INT					NOT NULL
PRIMARY KEY(CODIGO)
FOREIGN KEY(ESPECIALIDADE_ID)
		REFERENCES ESPECIALIDADE (ID)
)

CREATE TABLE CONSULTA(
PACIENTE_NUM_BENEFICIARIO			INT				NOT NULL,
MEDICO_CODIGO						INT				NOT NULL,
DATA_HORA							TIME			NOT NULL,
OBSERVACAO							VARCHAR(255)	NOT NULL
PRIMARY KEY (DATA_HORA)
FOREIGN KEY (PACIENTE_NUM_BENEFICIARIO)
		REFERENCES PACIENTE (NUM_BENEFICIARIO),
FOREIGN KEY (MEDICO_CODIGO)
		REFERENCES MEDICO (CODIGO)	
)

DROP TABLE MEDICO
DROP TABLE CONSULTA
USE MASTER


INSERT INTO PACIENTE (NUM_BENEFICIARIO, NOME, LOGRADOURO, NUMERO, CEP, COMPLEMENTO, TELEFONE)
VALUES 
(99901, 'WASHINGTON SILVA', 'R.ANHAI'                ,  150, '02345000', 'CASA'                 , '922229999'),
(99902, 'LUIS RICARDO'    , 'R.VOLUNTARIOS DA PATRIA', 2251, '03254010', 'BLOCO B.APTO 25'      , '923450987'),
(99903, 'MARIA ELISA'     , 'AV.AGUIA DE HAIA'       , 1188, '06987020', 'APTO 1208'            , '912348765'),
(99904, 'JOSÉ ARAUJO'     , 'R. XV DE NOVEMBRO'      ,   18, '03678000', 'CASA'                 , '945674312'),
(99905, 'JOANA PAULA'     , 'R. 7 DE ABRIL'          ,   97, '01214000', 'CONJUNTO 3 - APTO 801', '912095674')

INSERT INTO ESPECIALIDADE (ID, ESPECIALIDADE)
VALUES
(1, 'OTORRINOLARINGOLOGISTA'),
(2,             'UROLOGISTA'),
(3,               'GERIATRA'),
(4,               'PEDIATRA')

INSERT INTO MEDICO (CODIGO, NOME, LOGRADOURO, NUMERO, CEP, COMPLEMENTO, CONTATO, ESPECIALIDADE_ID)
VALUES
(100001, 'ANA PAULA'       , 'R. 7 DE SETEMBRO'     ,  256, '03698000',     'CASA', '915689456', 1),
(100002, 'MARIA APARECIDA' , 'AV. BRASIL'           ,   32, '02145070',     'CASA', '923235454', 1),
(100003, 'LUCAS BORGES'    , 'AV. DO ESTADO'        , 3210, '05241000', 'APTO 205', '963698585', 2),
(100004, 'GABRIEL OLIVEIRA', 'AV. DOM HELDER CAMARA',  350, '03145000', 'APTO 602', '932458745', 3)

INSERT CONSULTA (PACIENTE_NUM_BENEFICIARIO, MEDICO_CODIGO, DATA_HORA, OBSERVACAO)
VALUES
(99901, 100002, '2021-09-04 13:20',    'INFECÇÃO URINA'),
(99902, 100003, '2021-09-04 13:15',             'GRIPE'),
(99901, 100002, '2021-09-04 12:30', 'INFECÇÃO GARGANTA')

SELECT * FROM MEDICO

SELECT * 
FROM MEDICO
WHERE NOME = 'ANA PAULA'

ALTER TABLE MEDICO
ADD DIA_ATENDIMENTO		VARCHAR(9)		NULL

SELECT * FROM MEDICO 

UPDATE MEDICO
SET DIA_ATENDIMENTO = '2º FEIRA'
WHERE CODIGO = 100001

UPDATE MEDICO
SET DIA_ATENDIMENTO = '4º FEIRA'
WHERE CODIGO = 100002

UPDATE MEDICO
SET DIA_ATENDIMENTO = '2º FEIRA'
WHERE CODIGO = 100003

UPDATE MEDICO
SET DIA_ATENDIMENTO = '5º FEIRA'
WHERE CODIGO = 100004

USE CLINICA

EXEC SP_RENAME 'dbo.MEDICO.DIA_ATENDIMENTO', 'DIA_SEMANA_ATENDIMENTO' , 'COLUMN'

SELECT * FROM MEDICO

UPDATE MEDICO
SET LOGRADOURO = 'AV. BRAS LEME', NUMERO = '876', COMPLEMENTO = 'APTO 504', CEP = '02122000'
WHERE CODIGO = 100003

ALTER TABLE CONSULTA
ALTER COLUMN OBSERVACAO VARCHAR(200) NOT NULL

DELETE ESPECIALIDADE
WHERE ID = 4

SELECT * FROM ESPECIALIDADE